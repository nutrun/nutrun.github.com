<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<?xml version="1.0" encoding="strict" ?>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml:">
  <head>
    <title>nutrun</title>
    <link href="http://feeds.feedburner.com/nutrun/feed" rel="alternate" title="nutrun RSS feed" type="application/atom+xml" />
    <link charset="utf-8" href="/css/reset.css" media="all" rel="stylesheet" type="text/css" />
    <link charset="utf-8" href="/css/screen.css" media="all" rel="stylesheet" type="text/css" />
    <meta content="nutrun.com is George Malamidis's website and blog focused on software engineering." name="description" />
    <meta content="nutrun, George, Malamidis, programming, distributed, web, software, engineering" name="keywords" />
  </head>
  <body>
    <div id="site">
      <div id="header">
        <h1>
          <a href="/" rel="home">nutrun</a>
        </h1>
      </div>
      <div id="menu">
        <ul>
          <li>
            <a class="home" href="/" rel="home">Home</a>
          </li>
          <li>
            <a class="twitter" href="http://twitter.com/nutrun">Twitter</a>
          </li>
          <li>
            <a class="feed" href="http://feeds.feedburner.com/nutrun/feed">Feed</a>
          </li>
          <li>
            <a class="search" href="/search.html">Search</a>
          </li>
        </ul>
      </div>
      <div id="content">
        <div class="article">
          <div>
            <span class="date">May 18 2009</span>
          </div>
          <h2 class="title">Rack::CacheHeaders code</h2>
          <p>
            A few months ago I
            <a href="http://nutrun.com/weblog/rack-cache-headers/" title="nutrun  » Blog Archive   » Rack cache headers">wrote</a>
            about a possible method for centrally configuring HTTP cache headers in
            <a href="http://rack.rubyforge.org/" title="Rack: a Ruby Webserver Interface">Rack</a>
            based web applications which I called
            <code>Rack::CacheHeaders</code>.
            This is useful if your application's architecture involves tools like
            <a href="http://www.squid-cache.org/" title="squid : Optimising Web Delivery">Squid</a>
            or
            <a href="http://varnish.projects.linpro.no/" title="Varnish - Trac">Varnish</a>,
            or if you are generally interested in harvesting the numerous advantages of HTTP caching for your web application.
          </p>
          <p>
            The code has evolved a bit since and proven useful in a number of production systems. I created a
            <a href="http://gist.github.com/113441" title="gist: 113441 - GitHub">gist</a>
            of
            <code>Rack::CacheHeaders</code>
            in case someone else finds it handy. The tool is not exhaustive in terms of policies as found in the HTTP
            <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html" title="HTTP/1.1: Caching in HTTP">specs</a>,
            it's a collection of the ones we needed in the projects it's been used so far. Consider adding ones you need to the gist to make the code more complete and widely useful.
          </p>
          <p>
            <code>Rack::CacheHeaders</code>
            allows configuring HTTP cache policy response headers based on request URI patterns. For example, to set the
            <code>Cache-Control: max-age</code>
            header for a
            <code>/guitars/:id</code>
            resource to one hour:
          </p>
          <pre>&#x000A;Rack::CacheHeaders.configure do |cache|&#x000A;  cache.max_age(/^\/guitars\/d+$/, 3600)&#x000A;end</pre>
          <p>
            <a href="http://gist.github.com/113441" title="gist: 113441 - GitHub">Download/develop Rack::CacheHeaders</a>
          </p>
        </div>
      </div>
      <div id="footer">
        <p>All content &copy; 2006-2011 George Malamidis, nutrun</p>
        <p>
          Nut icon by Achilles Charmpilas @
          <a href="http://humbuckercode.co.uk">humbuckercode.co.uk</a>
        </p>
        <p>
          Fugue icons by
          <a href="http://p.yusukekamiyamane.com/">Yusuke Kamiyamane</a>
        </p>
      </div>
    </div>
    <script type="text/javascript">
      //<![CDATA[
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      //]]>
    </script>
    <script type="text/javascript">
      //<![CDATA[
        var pageTracker = _gat._getTracker("UA-402519-1");
        pageTracker._initData();
        pageTracker._trackPageview();
      //]]>
    </script>
  </body>
</html>
